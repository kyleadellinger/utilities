# PACKER block:
# contains Packer settings, including version
# required plugins are also here
# each plugin block contains a 'version' and a 'source' attribute
# 'source' is only necessary when using a plugin outside of hashi

# SOURCE block:
# configures a specific 'builder' plugin, which is invoked by BUILD block
# uses 'builders' and 'communicators' to define:
#       - virtualization to use
#       - how to launch image being provisioned
#       - how to connect to it
# builders and communicators bundled together and configured in SOURCE block
# SOURCE can be reused across multiple builds
# multiple SOURCEs can be used in a single build
# two important labels:
#       - builder type
#       - name
# in example, 'builder' type is 'docker', 'name' is 'ubuntu'
# each 'builder' has own attributes

# BUILD block:
# defines what Packer should do with artifact after it launches
# in example, 'build' block references image defined by SOURCE block

# VARIABLEs
# variable precedence, from lowest to highest:
# variable defaults, environment variables, variable file(s), command-line
####### eg command line variable file:
# packer build --var-file=example.pkrvars/hcl packer-file-build.pkr.hcl
# packer will automatically load any variable file that matches the name:
# *.auto.pkrvars.hcl
# without needing to pass file via command line.
####### eg command line flag:
# packer build --var docker_image=ubuntu:focal .
####### eg ENV VARs
# packer will read env vars in form of `PKR_VAR_$name` to find values;
# they are typed in config then as `$name`.

# note that the files in a directory can be named anything:
# all files ending in .pkr.hcl
#

# packer initialize
# packer init $dir
# initializing will download plugins. will exit without output if already present.

# format
# packer fmt $file

# validate
# packer validate $file

# build ex:
# packer build docker-ubuntu.pkr.hcl
